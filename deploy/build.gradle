plugins {
  id 'java'
  id 'java-library'
  id 'org.bytedeco.gradle-javacpp-platform' version "1.5.8"
}

ext {
  javacppPlatform = 'windows-x86_64'
}

group 'de.lukasbreuer.stockalgorithm'
version '1.0.0-SNAPSHOT'

repositories {
  mavenCentral()
}

configurations {
  projectImplementation
}

sourceSets {
  main {
    compileClasspath += configurations.projectImplementation
  }
}

dependencies {
  projectImplementation("de.lukasbreuer.stockalgorithm:core:1.0.0-SNAPSHOT")

  annotationProcessor 'org.projectlombok:lombok:1.18.24'
  testAnnotationProcessor 'org.projectlombok:lombok:1.18.24'

  implementation "org.seleniumhq.selenium:selenium-java:4.7.2"
  implementation "io.github.bonigarcia:webdrivermanager:5.3.1"
}

test {
  useJUnitPlatform()
}

jar {
  duplicatesStrategy(DuplicatesStrategy.EXCLUDE)

  manifest {
    attributes(
      'Main-Class': 'de.lukasbreuer.stockalgorithm.deploy.DeployApplication'
    )
  }

  from {
    (configurations.runtimeClasspath + configurations.projectImplementation).collect {
      it.isDirectory() ? it : zipTree(it)
    }
  }

  exclude 'META-INF/MANIFEST.MF'
  exclude 'META-INF/*.SF'
  exclude 'META-INF/*.DSA'
  exclude 'META-INF/*.RSA'
}